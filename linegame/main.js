!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t){return t[0]}function s(t){const e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode(t)),document.head.appendChild(e)}i.r(e),window.addEventListener("contextmenu",t=>t.preventDefault()),s(n`canvas{position:fixed;left:50%;top:0;height:100%;transform:translate(-50%, 0)}`),Array.prototype.last=function(){return this[this.length-1]};s(n`html{height:100%;width:100%;overflow:hidden;touch-action:none}body{height:100%;overflow:hidden;margin:0;width:100%;touch-action:none}.fullscreenfix{overflow:hidden;height:100%;width:100%;touch-action:none;background-color:#000}`),document.body.classList.add("ui");let o=document.createElement("div");o.classList.add("fullscreenfix"),o.setAttribute("touch-action","none");let h=document.createElement("button");h.appendChild(document.createTextNode("Enter Fullscreen")),h.addEventListener("click",()=>{!function(t){try{t.requestFullscreen()}catch(e){try{t.webkitRequestFullScreen()}catch(t){alert("Fullscreen not available.")}}}(o)}),o.appendChild(h);let l=document.createElement("button");l.appendChild(document.createTextNode("Refresh")),l.addEventListener("click",()=>{location.reload()}),o.appendChild(l);const r=new class{constructor(){this.canvas=document.createElement("canvas"),this.canvas.appendChild(document.createTextNode("This browser does not support canvas.")),this.canvas.width=800,this.canvas.height=600;let t=this.canvas.getContext("2d");if(!t)throw alert("Could not get rendering context."),new Error("Could not get rendering context");this.ctx=t,this.vx=0,this.vy=0,this.canJumpTimer=0,this.line=[{x:25,y:25}],this.renderLoop(),this.updateLoop(),this.keys={},document.onkeydown=t=>{this.keys[t.key]=!0},document.onkeyup=t=>{delete this.keys[t.key]}}async renderLoop(){for(;;)await new Promise(t=>setTimeout(t,1e3/70)),await new Promise(t=>window.requestAnimationFrame(t)),this.ctx.fillStyle="white",this.ctx.lineWidth=0,this.ctx.fillRect(0,0,800,600),this.ctx.fillStyle="yellow",this.ctx.shadowColor="yellow",this.ctx.shadowBlur=25,this.ctx.beginPath(),this.ctx.arc(this.line.last().x,this.line.last().y,25,25,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill(),this.ctx.shadowBlur=0,this.ctx.fillStyle="black",this.ctx.strokeStyle="black",this.ctx.lineWidth=5,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(this.line[0].x-1,this.line[0].y-1),this.line.forEach(({x:t,y:e},i)=>{(i===this.line.length-60||this.line.length<60&&0===i)&&(this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.strokeStyle="darkgrey"),this.ctx.lineTo(t,e)}),this.ctx.stroke(),this.ctx.fillStyle=this.canJumpTimer>0?"red":"lightblue",this.ctx.beginPath(),this.ctx.arc(this.line.last().x,this.line.last().y,5,5,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()}updateLoop(){setInterval(()=>{let t=this.line.last().x,e=this.line.last().y;this.vx*=.9,this.vy+=.3,this.vy=Math.min(this.vy,10),this.canJumpTimer--,this.keys.ArrowRight&&(this.vx=Math.min(this.vx+.6,5)),this.keys.ArrowLeft&&(this.vx=Math.max(this.vx-.6,-5));let i=t+this.vx,n=e+this.vy,s=(s,o)=>{let h=function(t,e,i,n,s,o,h,l){if(t===i&&e===n||s===h&&o===l)return!1;let r=(l-o)*(i-t)-(h-s)*(n-e);if(0===r)return!1;let c=((h-s)*(e-o)-(l-o)*(t-s))/r,a=((i-t)*(e-o)-(n-e)*(t-s))/r;return!(c<0||c>1||a<0||a>1)&&{x:t+c*(i-t),y:e+c*(n-e)}}(t,e,i,n,o.x,o.y,s.x,s.y);if(h){let s=n-e,o=i-t;n=h.y-s/10,this.vy=-this.vy,this.vx=-this.vx,i=h.x-o/10,this.canJumpTimer=60}};this.line.forEach((t,e)=>{if(e>=this.line.length-60)return;let i=this.line[e-1];i&&s(i,t)}),s({x:0,y:600},{x:800,y:600}),s({x:800,y:0},{x:800,y:600}),s({x:0,y:0},{x:800,y:0}),s({x:0,y:0},{x:0,y:600}),this.keys.ArrowUp&&this.canJumpTimer>0&&(console.log("up"),this.vy=-7,this.canJumpTimer=0),-.0125<=this.vx&&this.vx<=.0125&&(this.vx=0),-.0125<=this.vy&&this.vy<=.0125&&(this.vy=0),(this.vx||this.vy)&&this.line.push({x:i,y:n}),this.line.length>120&&this.line.shift()},1e3/60)}};o.appendChild(r.canvas),document.body.appendChild(o)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0dhbWUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiY3NzIiwidGV4dCIsImFkZFN0eWxlc2hlZXQiLCJzdHlsZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInR5cGUiLCJhcHBlbmRDaGlsZCIsImNyZWF0ZVRleHROb2RlIiwiaGVhZCIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJ1dGlsIiwiQXJyYXkiLCJsYXN0IiwidGhpcyIsImxlbmd0aCIsImJvZHkiLCJjbGFzc0xpc3QiLCJhZGQiLCJmdWxsc2NyZWVuRml4Iiwic2V0QXR0cmlidXRlIiwiZW50ZXJGdWxsc2NyZWVuIiwibm9kZSIsInJlcXVlc3RGdWxsc2NyZWVuIiwid2Via2l0UmVxdWVzdEZ1bGxTY3JlZW4iLCJhbGVydCIsInJlZnJlc2giLCJsb2NhdGlvbiIsInJlbG9hZCIsImdhbWUiLCJjb25zdHJ1Y3RvciIsImNhbnZhcyIsIndpZHRoIiwiaGVpZ2h0IiwicmMyZCIsImdldENvbnRleHQiLCJFcnJvciIsImN0eCIsInZ4IiwidnkiLCJjYW5KdW1wVGltZXIiLCJsaW5lIiwieCIsInkiLCJyZW5kZXJMb29wIiwidXBkYXRlTG9vcCIsImtleXMiLCJvbmtleWRvd24iLCJvbmtleXVwIiwiW29iamVjdCBPYmplY3RdIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiZmlsbFN0eWxlIiwibGluZVdpZHRoIiwiZmlsbFJlY3QiLCJzaGFkb3dDb2xvciIsInNoYWRvd0JsdXIiLCJiZWdpblBhdGgiLCJhcmMiLCJNYXRoIiwiUEkiLCJjbG9zZVBhdGgiLCJmaWxsIiwic3Ryb2tlU3R5bGUiLCJsaW5lQ2FwIiwibW92ZVRvIiwiZm9yRWFjaCIsInN0cm9rZSIsImxpbmVUbyIsInNldEludGVydmFsIiwicHJldlgiLCJwcmV2WSIsIm1pbiIsIkFycm93UmlnaHQiLCJBcnJvd0xlZnQiLCJtYXgiLCJuZXdYIiwibmV3WSIsImNvbERlYyIsInByZXZTZWdtZW50Iiwic2VnbWVudCIsImludGVyc2VjdGlvbiIsIngxIiwieTEiLCJ4MiIsInkyIiwieDMiLCJ5MyIsIng0IiwieTQiLCJkZW5vbWluYXRvciIsInVhIiwidWIiLCJpbnRlcnNlY3QiLCJkeSIsImR4IiwiQXJyb3dVcCIsImNvbnNvbGUiLCJsb2ciLCJwdXNoIiwic2hpZnQiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMs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QzdCbkYsS0FBSzBCLGFBQWUsS0FHeEIxQixLQUFLMkIsS0FBSzJCLFFBQVEsQ0FBQ2MsRUFBU3JILEtBQzFCLEdBQUlBLEdBQUtpRCxLQUFLMkIsS0FBSzFCLE9BQVMsR0FDMUIsT0FFRixJQUFJa0UsRUFBY25FLEtBQUsyQixLQUFLNUUsRUFBSSxHQUMzQm9ILEdBR0xELEVBQU9DLEVBQWFDLEtBRXRCRixFQUFPLENBQUV0QyxFQUFHLEVBQUdDLEVBQUcsS0FBTyxDQUFFRCxFQUFHLElBQUtDLEVBQUcsTUFDdENxQyxFQUFPLENBQUV0QyxFQUFHLElBQUtDLEVBQUcsR0FBSyxDQUFFRCxFQUFHLElBQUtDLEVBQUcsTUFDdENxQyxFQUFPLENBQUV0QyxFQUFHLEVBQUdDLEVBQUcsR0FBSyxDQUFFRCxFQUFHLElBQUtDLEVBQUcsSUFDcENxQyxFQUFPLENBQUV0QyxFQUFHLEVBQUdDLEVBQUcsR0FBSyxDQUFFRCxFQUFHLEVBQUdDLEVBQUcsTUFFOUI3QixLQUFLZ0MsS0FBS29ELFNBQVdwRixLQUFLMEIsYUFBZSxJQUMzQzJELFFBQVFDLElBQUksTUFDWnRGLEtBQUt5QixJQUFNLEVBQ1h6QixLQUFLMEIsYUFBZSxJQUdqQixPQUFVMUIsS0FBS3dCLElBQU14QixLQUFLd0IsSUFBTSxRQUNuQ3hCLEtBQUt3QixHQUFLLElBR1AsT0FBVXhCLEtBQUt5QixJQUFNekIsS0FBS3lCLElBQU0sUUFDbkN6QixLQUFLeUIsR0FBSyxJQUdSekIsS0FBS3dCLElBQU14QixLQUFLeUIsS0FDbEJ6QixLQUFLMkIsS0FBSzRELEtBQUssQ0FBRTNELEVBQUdvQyxFQUFNbkMsRUFBR29DLElBRTNCakUsS0FBSzJCLEtBQUsxQixPQUFTLEtBQ3JCRCxLQUFLMkIsS0FBSzZELFNBR1gsSUFBTyxNQ2pMZG5GLEVBQWNmLFlBQVl5QixFQUFLRSxRQUUvQjlCLFNBQVNlLEtBQUtaLFlBQVllIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJ3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGUgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNzcyh0ZXh0OiBUZW1wbGF0ZVN0cmluZ3NBcnJheSkge1xuICAvLyByZXR1cm4gdGV4dC5yZWR1Y2UoKHRvdGFsLCB2LCBpKSA9PiB0b3RhbCArIHYgKyAodmFsdWVzW2ldIHx8IFwiXCIpLCBcIlwiKTtcbiAgcmV0dXJuIHRleHRbMF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRTdHlsZXNoZWV0KGNzczogc3RyaW5nKSB7XG4gIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICBzdHlsZS50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xuICBzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpKTtcblxuICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlcXVlc3RGdWxsc2NyZWVuKG5vZGU6IEhUTUxFbGVtZW50KSB7XG4gIHRyeSB7XG4gICAgbm9kZS5yZXF1ZXN0RnVsbHNjcmVlbigpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgbm9kZS53ZWJraXRSZXF1ZXN0RnVsbFNjcmVlbigpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGFsZXJ0KFwiRnVsbHNjcmVlbiBub3QgYXZhaWxhYmxlLlwiKTtcbiAgICB9XG4gIH1cbn0iLCJpbXBvcnQgKiBhcyB1dGlsIGZyb20gXCIuL3V0aWxcIjtcblxuY29uc3QgJHNjc3MgPSB1dGlsLmNzcztcblxudXRpbC5hZGRTdHlsZXNoZWV0KCRzY3NzYFxuY2FudmFze1xuXHRwb3NpdGlvbjpmaXhlZDtcblx0bGVmdDo1MCU7XG5cdHRvcDowO1xuXHRoZWlnaHQ6MTAwJTtcblx0dHJhbnNmb3JtOnRyYW5zbGF0ZSgtNTAlLDApO1xufVxuYCk7XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIEFycmF5PFQ+IHtcbiAgICBsYXN0KCk6IFQ7XG4gIH1cbn1cblxuQXJyYXkucHJvdG90eXBlLmxhc3QgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXNbdGhpcy5sZW5ndGggLSAxXTtcbn07XG5cbmZ1bmN0aW9uIGludGVyc2VjdChcbiAgeDE6IG51bWJlcixcbiAgeTE6IG51bWJlcixcbiAgeDI6IG51bWJlcixcbiAgeTI6IG51bWJlcixcbiAgeDM6IG51bWJlcixcbiAgeTM6IG51bWJlcixcbiAgeDQ6IG51bWJlcixcbiAgeTQ6IG51bWJlclxuKSB7XG4gIGlmICgoeDEgPT09IHgyICYmIHkxID09PSB5MikgfHwgKHgzID09PSB4NCAmJiB5MyA9PT0geTQpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGxldCBkZW5vbWluYXRvciA9ICh5NCAtIHkzKSAqICh4MiAtIHgxKSAtICh4NCAtIHgzKSAqICh5MiAtIHkxKTtcblxuICBpZiAoZGVub21pbmF0b3IgPT09IDApIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgbGV0IHVhID0gKCh4NCAtIHgzKSAqICh5MSAtIHkzKSAtICh5NCAtIHkzKSAqICh4MSAtIHgzKSkgLyBkZW5vbWluYXRvcjtcbiAgbGV0IHViID0gKCh4MiAtIHgxKSAqICh5MSAtIHkzKSAtICh5MiAtIHkxKSAqICh4MSAtIHgzKSkgLyBkZW5vbWluYXRvcjtcblxuICBpZiAodWEgPCAwIHx8IHVhID4gMSB8fCB1YiA8IDAgfHwgdWIgPiAxKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgbGV0IHggPSB4MSArIHVhICogKHgyIC0geDEpO1xuICBsZXQgeSA9IHkxICsgdWEgKiAoeTIgLSB5MSk7XG5cbiAgcmV0dXJuIHsgeCwgeSB9O1xufVxuXG5leHBvcnQgY2xhc3MgR2FtZSB7XG4gIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQ7XG4gIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xuICBsaW5lOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH1bXTtcbiAgdng6IG51bWJlcjtcbiAgdnk6IG51bWJlcjtcbiAga2V5czogeyBbbmFtZTogc3RyaW5nXTogdHJ1ZSB8IHVuZGVmaW5lZCB9O1xuICBjYW5KdW1wVGltZXI6IG51bWJlcjtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuICAgIHRoaXMuY2FudmFzLmFwcGVuZENoaWxkKFxuICAgICAgZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJUaGlzIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBjYW52YXMuXCIpXG4gICAgKTtcbiAgICB0aGlzLmNhbnZhcy53aWR0aCA9IDgwMDtcbiAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSA2MDA7XG4gICAgbGV0IHJjMmQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgaWYgKCFyYzJkKSB7XG4gICAgICBhbGVydChcIkNvdWxkIG5vdCBnZXQgcmVuZGVyaW5nIGNvbnRleHQuXCIpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IGdldCByZW5kZXJpbmcgY29udGV4dFwiKTtcbiAgICB9XG4gICAgdGhpcy5jdHggPSByYzJkO1xuICAgIHRoaXMudnggPSAwO1xuICAgIHRoaXMudnkgPSAwO1xuICAgIHRoaXMuY2FuSnVtcFRpbWVyID0gMDtcblxuICAgIHRoaXMubGluZSA9IFt7IHg6IDI1LCB5OiAyNSB9XTtcblxuICAgIHRoaXMucmVuZGVyTG9vcCgpO1xuICAgIHRoaXMudXBkYXRlTG9vcCgpO1xuXG4gICAgdGhpcy5rZXlzID0ge307XG5cbiAgICBkb2N1bWVudC5vbmtleWRvd24gPSBlID0+IHtcbiAgICAgIHRoaXMua2V5c1tlLmtleV0gPSB0cnVlO1xuICAgIH07XG4gICAgZG9jdW1lbnQub25rZXl1cCA9IGUgPT4ge1xuICAgICAgZGVsZXRlIHRoaXMua2V5c1tlLmtleV07XG4gICAgfTtcbiAgfVxuICBhc3luYyByZW5kZXJMb29wKCkge1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCAvIDcwKSk7XG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocmVzb2x2ZSkpO1xuICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gXCJ3aGl0ZVwiO1xuICAgICAgdGhpcy5jdHgubGluZVdpZHRoID0gMDtcbiAgICAgIHRoaXMuY3R4LmZpbGxSZWN0KDAsIDAsIDgwMCwgNjAwKTtcblxuICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gXCJ5ZWxsb3dcIjtcbiAgICAgIHRoaXMuY3R4LnNoYWRvd0NvbG9yID0gXCJ5ZWxsb3dcIjtcbiAgICAgIHRoaXMuY3R4LnNoYWRvd0JsdXIgPSAyNTtcbiAgICAgIHRoaXMuY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgdGhpcy5jdHguYXJjKFxuICAgICAgICB0aGlzLmxpbmUubGFzdCgpLngsXG4gICAgICAgIHRoaXMubGluZS5sYXN0KCkueSxcbiAgICAgICAgMjUsXG4gICAgICAgIDI1LFxuICAgICAgICBNYXRoLlBJICogMixcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICAgIHRoaXMuY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgdGhpcy5jdHguZmlsbCgpO1xuXG4gICAgICB0aGlzLmN0eC5zaGFkb3dCbHVyID0gMDtcbiAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IFwiYmxhY2tcIjtcbiAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gXCJibGFja1wiO1xuICAgICAgdGhpcy5jdHgubGluZVdpZHRoID0gNTtcbiAgICAgIHRoaXMuY3R4LmxpbmVDYXAgPSBcInJvdW5kXCI7XG4gICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcbiAgICAgIHRoaXMuY3R4Lm1vdmVUbyh0aGlzLmxpbmVbMF0ueCAtIDEsIHRoaXMubGluZVswXS55IC0gMSk7XG4gICAgICB0aGlzLmxpbmUuZm9yRWFjaCgoeyB4LCB5IH0sIGkpID0+IHtcbiAgICAgICAgaWYgKGkgPT09IHRoaXMubGluZS5sZW5ndGggLSA2MCB8fCAodGhpcy5saW5lLmxlbmd0aCA8IDYwICYmIGkgPT09IDApKSB7XG4gICAgICAgICAgdGhpcy5jdHguc3Ryb2tlKCk7XG4gICAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgdGhpcy5jdHgubW92ZVRvKHgsIHkpO1xuICAgICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gXCJkYXJrZ3JleVwiO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3R4LmxpbmVUbyh4LCB5KTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5jdHguc3Ryb2tlKCk7XG5cbiAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IHRoaXMuY2FuSnVtcFRpbWVyID4gMCA/IFwicmVkXCIgOiBcImxpZ2h0Ymx1ZVwiO1xuICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICB0aGlzLmN0eC5hcmMoXG4gICAgICAgIHRoaXMubGluZS5sYXN0KCkueCxcbiAgICAgICAgdGhpcy5saW5lLmxhc3QoKS55LFxuICAgICAgICA1LFxuICAgICAgICA1LFxuICAgICAgICBNYXRoLlBJICogMixcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICAgIHRoaXMuY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgdGhpcy5jdHguZmlsbCgpO1xuICAgIH1cbiAgfVxuICB1cGRhdGVMb29wKCkge1xuICAgIGNvbnN0IGxvb3AgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBsZXQgcHJldlggPSB0aGlzLmxpbmUubGFzdCgpLng7XG4gICAgICBsZXQgcHJldlkgPSB0aGlzLmxpbmUubGFzdCgpLnk7XG4gICAgICB0aGlzLnZ4ICo9IDAuOTtcbiAgICAgIHRoaXMudnkgKz0gMC4zO1xuICAgICAgdGhpcy52eSA9IE1hdGgubWluKHRoaXMudnksIDEwKTtcbiAgICAgIHRoaXMuY2FuSnVtcFRpbWVyLS07XG4gICAgICBpZiAodGhpcy5rZXlzLkFycm93UmlnaHQpIHtcbiAgICAgICAgdGhpcy52eCA9IE1hdGgubWluKHRoaXMudnggKyAwLjYsIDUpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMua2V5cy5BcnJvd0xlZnQpIHtcbiAgICAgICAgdGhpcy52eCA9IE1hdGgubWF4KHRoaXMudnggLSAwLjYsIC01KTtcbiAgICAgIH1cbiAgICAgIGxldCBuZXdYID0gcHJldlggKyB0aGlzLnZ4O1xuICAgICAgbGV0IG5ld1kgPSBwcmV2WSArIHRoaXMudnk7XG5cbiAgICAgIGxldCBjb2xEZWMgPSAoXG4gICAgICAgIHByZXZTZWdtZW50OiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0sXG4gICAgICAgIHNlZ21lbnQ6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfVxuICAgICAgKSA9PiB7XG4gICAgICAgIGxldCBpbnRlcnNlY3Rpb24gPSBpbnRlcnNlY3QoXG4gICAgICAgICAgcHJldlgsXG4gICAgICAgICAgcHJldlksXG4gICAgICAgICAgbmV3WCxcbiAgICAgICAgICBuZXdZLFxuICAgICAgICAgIHNlZ21lbnQueCxcbiAgICAgICAgICBzZWdtZW50LnksXG4gICAgICAgICAgcHJldlNlZ21lbnQueCxcbiAgICAgICAgICBwcmV2U2VnbWVudC55XG4gICAgICAgICk7XG4gICAgICAgIGlmIChpbnRlcnNlY3Rpb24pIHtcbiAgICAgICAgICBsZXQgZHkgPSBuZXdZIC0gcHJldlk7XG4gICAgICAgICAgbGV0IGR4ID0gbmV3WCAtIHByZXZYO1xuICAgICAgICAgIG5ld1kgPSBpbnRlcnNlY3Rpb24ueSAtIGR5IC8gMTA7XG4gICAgICAgICAgdGhpcy52eSA9IC10aGlzLnZ5O1xuICAgICAgICAgIHRoaXMudnggPSAtdGhpcy52eDtcbiAgICAgICAgICBuZXdYID0gaW50ZXJzZWN0aW9uLnggLSBkeCAvIDEwO1xuICAgICAgICAgIHRoaXMuY2FuSnVtcFRpbWVyID0gNjA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB0aGlzLmxpbmUuZm9yRWFjaCgoc2VnbWVudCwgaSkgPT4ge1xuICAgICAgICBpZiAoaSA+PSB0aGlzLmxpbmUubGVuZ3RoIC0gNjApIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHByZXZTZWdtZW50ID0gdGhpcy5saW5lW2kgLSAxXTtcbiAgICAgICAgaWYgKCFwcmV2U2VnbWVudCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb2xEZWMocHJldlNlZ21lbnQsIHNlZ21lbnQpO1xuICAgICAgfSk7XG4gICAgICBjb2xEZWMoeyB4OiAwLCB5OiA2MDAgfSwgeyB4OiA4MDAsIHk6IDYwMCB9KTtcbiAgICAgIGNvbERlYyh7IHg6IDgwMCwgeTogMCB9LCB7IHg6IDgwMCwgeTogNjAwIH0pO1xuICAgICAgY29sRGVjKHsgeDogMCwgeTogMCB9LCB7IHg6IDgwMCwgeTogMCB9KTtcbiAgICAgIGNvbERlYyh7IHg6IDAsIHk6IDAgfSwgeyB4OiAwLCB5OiA2MDAgfSk7XG5cbiAgICAgIGlmICh0aGlzLmtleXMuQXJyb3dVcCAmJiB0aGlzLmNhbkp1bXBUaW1lciA+IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ1cFwiKTtcbiAgICAgICAgdGhpcy52eSA9IC03O1xuICAgICAgICB0aGlzLmNhbkp1bXBUaW1lciA9IDA7XG4gICAgICB9XG5cbiAgICAgIGlmICgtMC4wMTI1IDw9IHRoaXMudnggJiYgdGhpcy52eCA8PSAwLjAxMjUpIHtcbiAgICAgICAgdGhpcy52eCA9IDA7XG4gICAgICB9XG5cbiAgICAgIGlmICgtMC4wMTI1IDw9IHRoaXMudnkgJiYgdGhpcy52eSA8PSAwLjAxMjUpIHtcbiAgICAgICAgdGhpcy52eSA9IDA7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnZ4IHx8IHRoaXMudnkpIHtcbiAgICAgICAgdGhpcy5saW5lLnB1c2goeyB4OiBuZXdYLCB5OiBuZXdZIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMubGluZS5sZW5ndGggPiAxMjApIHtcbiAgICAgICAgdGhpcy5saW5lLnNoaWZ0KCk7XG4gICAgICAgIC8vIHRoaXMubGluZS5zcGxpY2UoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy5saW5lLmxlbmd0aCksIDEpO1xuICAgICAgfVxuICAgIH0sIDEwMDAgLyA2MCk7XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIHV0aWwgZnJvbSBcIi4vdXRpbFwiO1xuaW1wb3J0IHsgR2FtZSB9IGZyb20gXCIuL0dhbWVcIjtcblxuY29uc3QgJHNjc3MgPSB1dGlsLmNzcztcblxudXRpbC5hZGRTdHlsZXNoZWV0KCRzY3NzYFxuaHRtbCB7XG4gIGhlaWdodDogMTAwJTtcbiAgd2lkdGg6MTAwJTtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgdG91Y2gtYWN0aW9uOiBub25lO1xufVxuYm9keXtcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICBtYXJnaW46IDA7XG4gICAgd2lkdGg6MTAwJTtcbiAgICB0b3VjaC1hY3Rpb246IG5vbmU7XG59XG4uZnVsbHNjcmVlbmZpeCB7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgd2lkdGg6MTAwJTtcbiAgICB0b3VjaC1hY3Rpb246IG5vbmU7XG4gICAgYmFja2dyb3VuZC1jb2xvcjpibGFjaztcbn1cbmApO1xuXG5kb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoXCJ1aVwiKTtcblxubGV0IGZ1bGxzY3JlZW5GaXggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuZnVsbHNjcmVlbkZpeC5jbGFzc0xpc3QuYWRkKFwiZnVsbHNjcmVlbmZpeFwiKTtcbmZ1bGxzY3JlZW5GaXguc2V0QXR0cmlidXRlKFwidG91Y2gtYWN0aW9uXCIsIFwibm9uZVwiKTtcblxubGV0IGVudGVyRnVsbHNjcmVlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5lbnRlckZ1bGxzY3JlZW4uYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJFbnRlciBGdWxsc2NyZWVuXCIpKTtcbmVudGVyRnVsbHNjcmVlbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICB1dGlsLnJlcXVlc3RGdWxsc2NyZWVuKGZ1bGxzY3JlZW5GaXgpO1xufSk7XG5mdWxsc2NyZWVuRml4LmFwcGVuZENoaWxkKGVudGVyRnVsbHNjcmVlbik7XG5cbmxldCByZWZyZXNoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbnJlZnJlc2guYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJSZWZyZXNoXCIpKTtcbnJlZnJlc2guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgbG9jYXRpb24ucmVsb2FkKCk7XG59KTtcbmZ1bGxzY3JlZW5GaXguYXBwZW5kQ2hpbGQocmVmcmVzaCk7XG5cbmNvbnN0IGdhbWUgPSBuZXcgR2FtZSgpO1xuZnVsbHNjcmVlbkZpeC5hcHBlbmRDaGlsZChnYW1lLmNhbnZhcyk7XG5cbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZnVsbHNjcmVlbkZpeCk7XG4iXSwic291cmNlUm9vdCI6IiJ9